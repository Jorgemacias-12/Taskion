on:
  push:
    branches:
      - main
    paths-ignore:
      - '**/[skip ci]'

name: üöÄ Deploy PHP Application on Push

jobs:
  php-deploy:
    name: üéâ Deploy
    runs-on: ubuntu-latest
    steps:
    - name: üöö Get latest code
      uses: actions/checkout@v3

    - name: üõ†Ô∏è Setup PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: '8.2'
        extensions: mbstring, xml, ctype, iconv, intl, pdo, pdo_mysql
        coverage: none

    - name: üß∞ Install Composer Dependencies
      run: composer install --no-progress --prefer-dist

    - name: Create .env file
      run: |
        echo "APP_ENV=production" >> .env
        echo "DB_HOST=${{ secrets.DB_HOST }}" >> .env
        echo "DB_NAME=${{ secrets.DB_NAME }}" >> .env
        echo "DB_USER=${{ secrets.DB_USER }}" >> .env
        echo "DB_PASSWORD=${{ secrets.DB_PASSWORD }}" >> .env
        # Agrega aqu√≠ otras variables de entorno necesarias para tu aplicaci√≥n

    - name: üìÇ Sync files
      uses: SamKirkland/FTP-Deploy-Action@v4.3.4
      with:
        server: ${{ secrets.FTP_SERVER }}
        username: ${{ secrets.FTP_USERNAME }}
        password: ${{ secrets.FTP_PASSWORD }}
        local-dir: ./
        # Aseg√∫rate de que la ruta est√© correcta y que la carpeta exista en tu repositorio
